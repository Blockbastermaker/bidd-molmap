# MolMap: A Molecule Representation Method Based on High-level Features

## MolMap
MolMap is generated by the following steps:

* Step1: Sample data 
* Step2: Feature extraction
* Step3: Calculate feature pairwise distance
* Step4: Feature 2D embedding
* Step5: Linear assignment to grid
* Step5: Transform
* Step6: Get MolMap


## installation

1. install [rdkit]('http://www.rdkit.org/docs/Install.html) first:
```bash
conda create -c rdkit -n my-rdkit-env rdkit
conda activate my-rdkit-env
```
2. in your "my-rdkit-env" env, install molmap by:

```bash
git clone https://github.com/shenwanxiang/bidd-molmap.git
cd bidd-molmap
pip install -r requirements.txt --user

# add molmap to PYTHONPATH
echo export PYTHONPATH="\$PYTHONPATH:`pwd`" >> ~/.bashrc

# init bashrc
source ~/.bashrc
```

3. [deepchem]('https://github.com/deepchem/deepchem') (optional). In our paper, deepchem has been used as a dataset provider, so you may install it by:
```bash
pip install deepchem==2.2.1.dev54
```

4. If you have gcc problems when you install molmap, please installing g++ first:
```bash
sudo apt-get install g++
```


## Usage

```python
import molmap
mp = molmap.MolMap(ftype = 'descriptor', fmap_type = 'grid')
mp.fit(method = 'umap', min_dist = 0.1, n_neighbors = 50)
```

```python
#visulization your molmap
mp.plot_scatter(htmlpath='./html', htmlname= 'test')
mp.plot_grid(htmlpath='./html', htmlname= 'grid')
```


```python
#transform smiles
smiles_list = ['CC(=O)OC1=CC=CC=C1C(O)=O', 
               'CC(=O)NC1=CC=CC=C1C(O)=O',
               'CC(=O)CC1=CC=CC=C1C(O)=O']
x = mp.batch_transform(smiles_list, scale = True, 
                       scale_method = 'standard', 
                       smoothing = True, kernel_size = 41, 
                       sigma=2)
print(x.shape)
#3,37,37
```

## Citaion:
```
{Shen et al. MolMapNet: An Efficient Convolutional Neural Network for Molecular Deep Learning}
```

